require "../example_helper"

Bioshogi.logger = ActiveSupport::Logger.new(STDOUT)

Board.dimensiton_change([2, 4])

mediator = Mediator.new
mediator.player_at(:black).pieces_add("金金")
mediator.board.placement_from_shape <<~EOT
+------+
| ・ ・|
| ・v玉|
| ・ ・|
| ・ 歩|
+------+
EOT

# tp mediator.player_at(:black).normal_all_hands(promoted_only: false, legal_only: true, mate_only: true)

brain = mediator.player_at(:black).brain(diver_class: NegaScoutDiver)
# records = brain.iterative_deepening(depth_max_range: 3..3, oute_mode: true, options2: {promoted_only: false, legal_only: true, mate_only: true})
# records = brain.iterative_deepening(depth_max_range: 3..3, oute_mode: true, options2: {promoted_only: false, legal_only: true, mate_only: true})
records = brain.iterative_deepening(depth_max_range: 3..3, oute_mode: true)
tp Brain.human_format(records)

# >> #ROOT ▲１三歩成(14)
# >>     0 △ △１三玉(12)
# >>     1 ▲     ▲１二金打
# >>     2 △         △１四玉(13)
# >>     3 ▲             -37645
# >>     2 △         △２四玉(13)
# >>     3 ▲             -37645
# >>     2 △         [<△２四玉(13)>]
# >>     2 △         △２三玉(13)
# >>     3 ▲             -37645
# >>     2 △         [<△２三玉(13)>]
# >>     2 △         △１二玉(13)
# >>     3 ▲             -40105
# >>     2 △         △１二玉(13)
# >>     3 ▲             -40105
# >>     2 △         [<△１二玉(13)>]
# >>     2 △         ★確 △１二玉(13)
# >>     1 ▲     ▲２三金打
# >>     2 △         △１四玉(13)
# >>     3 ▲             -37645
# >>     2 △         △２三玉(13)
# >>     3 ▲             -40105
# >>     1 ▲     [<▲２三金打>, <△２三玉(13)>]
# >>     1 ▲     ▲２四金打
# >>     2 △         △２四玉(13)
# >>     3 ▲             -40105
# >>     1 ▲     [<▲２四金打>, <△２四玉(13)>]
# >>     1 ▲     ▲１四金打
# >>     2 △         △１四玉(13)
# >>     3 ▲             -40105
# >>     1 ▲     [<▲１四金打>, <△１四玉(13)>]
# >>     1 ▲     ★確 ▲１二金打
# >>     0 △ △１一玉(12)
# >>     1 ▲     ▲２二と(13)
# >>     2 △         △２二玉(11)
# >>     3 ▲             -37585
# >>     2 △         ★確 △２二玉(11)
# >>     0 △ [<△１一玉(12)>, <▲２二と(13)>, <△２二玉(11)>]
# >>     0 △ △２一玉(12)
# >>     1 ▲     ▲２二と(13)
# >>     2 △         △２二玉(21)
# >>     3 ▲             -37585
# >>     2 △         ★確 △２二玉(21)
# >>     0 △ [<△２一玉(12)>, <▲２二と(13)>, <△２二玉(21)>]
# >>     0 △ ★確 △１三玉(12)
# >> #ROOT ▲１三歩(14)
# >>     0 △ △１三玉(12)
# >>     1 ▲     ▲１二金打
# >>     2 △         △１四玉(13)
# >>     3 ▲             -37645
# >>     2 △         △２四玉(13)
# >>     3 ▲             -37645
# >>     2 △         [<△２四玉(13)>]
# >>     2 △         △２三玉(13)
# >>     3 ▲             -37645
# >>     2 △         [<△２三玉(13)>]
# >>     2 △         △１二玉(13)
# >>     3 ▲             -40105
# >>     2 △         △１二玉(13)
# >>     3 ▲             -40105
# >>     2 △         [<△１二玉(13)>]
# >>     2 △         ★確 △１二玉(13)
# >>     1 ▲     ▲２三金打
# >>     2 △         △１四玉(13)
# >>     3 ▲             -37645
# >>     2 △         △２三玉(13)
# >>     3 ▲             -40105
# >>     1 ▲     [<▲２三金打>, <△２三玉(13)>]
# >>     1 ▲     ▲２四金打
# >>     2 △         △２四玉(13)
# >>     3 ▲             -40105
# >>     1 ▲     [<▲２四金打>, <△２四玉(13)>]
# >>     1 ▲     ▲１四金打
# >>     2 △         △１四玉(13)
# >>     3 ▲             -40105
# >>     1 ▲     [<▲１四金打>, <△１四玉(13)>]
# >>     1 ▲     ★確 ▲１二金打
# >>     0 △ △２三玉(12)
# >>     1 ▲     ▲２二金打
# >>     2 △         △１四玉(23)
# >>     3 ▲             -37440
# >>     2 △         △２四玉(23)
# >>     3 ▲             -37440
# >>     2 △         [<△２四玉(23)>]
# >>     2 △         △１三玉(23)
# >>     3 ▲             -37645
# >>     2 △         [<△１三玉(23)>]
# >>     2 △         △２二玉(23)
# >>     3 ▲             -39900
# >>     2 △         [<△２二玉(23)>]
# >>     2 △         ★確 △２二玉(23)
# >>     0 △ [<△２三玉(12)>, <▲２二金打>, <△２二玉(23)>]
# >>     0 △ △２二玉(12)
# >>     1 ▲     ▲１二歩成(13)
# >>     2 △         △２三玉(22)
# >>     3 ▲             -36280
# >>     2 △         △１二玉(22)
# >>     3 ▲             -37585
# >>     2 △         [<△１二玉(22)>]
# >>     2 △         ★確 △１二玉(22)
# >>     0 △ [<△２二玉(12)>, <▲１二歩成(13)>, <△１二玉(22)>]
# >>     0 △ △１一玉(12)
# >>     1 ▲     ▲１二歩成(13)
# >>     2 △         △１二玉(11)
# >>     3 ▲             -37585
# >>     2 △         ★確 △１二玉(11)
# >>     0 △ [<△１一玉(12)>, <▲１二歩成(13)>, <△１二玉(11)>]
# >>     0 △ △２一玉(12)
# >>     1 ▲     ▲１二歩成(13)
# >>     2 △         △１二玉(21)
# >>     3 ▲             -37585
# >>     2 △         ★確 △１二玉(21)
# >>     0 △ [<△２一玉(12)>, <▲１二歩成(13)>, <△１二玉(21)>]
# >>     0 △ ★確 △１三玉(12)
# >> #ROOT ▲１一金打
# >>     0 △ △２三玉(12)
# >>     1 ▲     ▲１三歩成(14)
# >>     2 △         △２四玉(23)
# >>     3 ▲             -36340
# >>     2 △         △１三玉(23)
# >>     3 ▲             -37645
# >>     2 △         △１三玉(23)
# >>     3 ▲             -37645
# >>     2 △         [<△１三玉(23)>]
# >>     2 △         ★確 △１三玉(23)
# >>     1 ▲     ▲２二金打
# >>     2 △         △１四玉(23)
# >>     3 ▲             -37705
# >>     1 ▲     [<▲２二金打>, <△１四玉(23)>]
# >>     1 ▲     ▲１三金打
# >>     2 △         △２四玉(23)
# >>     3 ▲             -37500
# >>     2 △         ★確 △２四玉(23)
# >>     1 ▲     ▲１三金打
# >>     2 △         △２四玉(23)
# >>     3 ▲             -37500
# >>     1 ▲     [<▲１三金打>, <△２四玉(23)>]
# >>     1 ▲     ▲２四金打
# >>     2 △         △２四玉(23)
# >>     3 ▲             -39960
# >>     1 ▲     [<▲２四金打>, <△２四玉(23)>]
# >>     1 ▲     ★確 ▲１三金打
# >>     0 △ △２二玉(12)
# >>     1 ▲     ▲２一金(11)
# >>     2 △         △２三玉(22)
# >>     3 ▲             -37440
# >>     2 △         △１二玉(22)
# >>     3 ▲             -37440
# >>     2 △         [<△１二玉(22)>]
# >>     2 △         △２一玉(22)
# >>     3 ▲             -39900
# >>     1 ▲     ▲１二金(11)
# >>     2 △         △２三玉(22)
# >>     3 ▲             -37440
# >>     2 △         △１二玉(22)
# >>     3 ▲             -39900
# >>     1 ▲     [<▲１二金(11)>, <△１二玉(22)>]
# >>     1 ▲     ▲１三歩成(14)
# >>     2 △         △１三玉(22)
# >>     3 ▲             -37645
# >>     1 ▲     [<▲１三歩成(14)>, <△１三玉(22)>]
# >>     1 ▲     ▲２一金打
# >>     2 △         △２三玉(22)
# >>     3 ▲             -37500
# >>     2 △         ★確 △２三玉(22)
# >>     0 △ [<△２二玉(12)>, <▲２一金打>, <△２三玉(22)>]
# >>     0 △ △１一玉(12)
# >>     1 ▲     ▲２一金打
# >>     2 △         △１二玉(11)
# >>     3 ▲             -39960
# >>     1 ▲     ▲２二金打
# >>     2 △         △２二玉(11)
# >>     3 ▲             -42420
# >>     1 ▲     [<▲２二金打>, <△２二玉(11)>]
# >>     1 ▲     ▲１二金打
# >>     2 △         △１二玉(11)
# >>     3 ▲             -42420
# >>     1 ▲     [<▲１二金打>, <△１二玉(11)>]
# >>     1 ▲     ★確 ▲２一金打
# >>     0 △ △１一玉(12)
# >>     1 ▲     ▲２一金打
# >>     2 △         △１二玉(11)
# >>     3 ▲             -39960
# >>     2 △         △２一玉(11)
# >>     3 ▲             -42420
# >>     2 △         △２一玉(11)
# >>     3 ▲             -42420
# >>     2 △         [<△２一玉(11)>]
# >>     2 △         ★確 △２一玉(11)
# >>     1 ▲     ▲２二金打
# >>     2 △         △２二玉(11)
# >>     3 ▲             -42420
# >>     1 ▲     [<▲２二金打>, <△２二玉(11)>]
# >>     1 ▲     ▲１二金打
# >>     2 △         △１二玉(11)
# >>     3 ▲             -42420
# >>     1 ▲     [<▲１二金打>, <△１二玉(11)>]
# >>     1 ▲     ★確 ▲２一金打
# >>     0 △ [<△１一玉(12)>, <▲２一金打>, <△２一玉(11)>]
# >>     0 △ ★確 △１一玉(12)
# >> #ROOT ▲２二金打
# >>     0 △ △２二玉(12)
# >>     1 ▲     ▲１三歩成(14)
# >>     2 △         △１三玉(22)
# >>     3 ▲             -40105
# >>     2 △         △１一玉(22)
# >>     3 ▲             -38800
# >>     2 △         [<△１一玉(22)>]
# >>     2 △         △２一玉(22)
# >>     3 ▲             -38800
# >>     2 △         [<△２一玉(22)>]
# >>     2 △         ★確 △１三玉(22)
# >>     1 ▲     ▲２一金打
# >>     2 △         △２三玉(22)
# >>     3 ▲             -39960
# >>     2 △         △１二玉(22)
# >>     3 ▲             -39960
# >>     2 △         [<△１二玉(22)>]
# >>     2 △         △２一玉(22)
# >>     3 ▲             -42420
# >>     1 ▲     [<▲２一金打>, <△２一玉(22)>]
# >>     1 ▲     ▲１二金打
# >>     2 △         △２三玉(22)
# >>     3 ▲             -39960
# >>     2 △         △１二玉(22)
# >>     3 ▲             -42420
# >>     1 ▲     [<▲１二金打>, <△１二玉(22)>]
# >>     1 ▲     ▲２三金打
# >>     2 △         △２三玉(22)
# >>     3 ▲             -42420
# >>     1 ▲     [<▲２三金打>, <△２三玉(22)>]
# >>     1 ▲     ▲１三金打
# >>     2 △         △１一玉(22)
# >>     3 ▲             -39960
# >>     2 △         △２一玉(22)
# >>     3 ▲             -39960
# >>     2 △         [<△２一玉(22)>]
# >>     2 △         ★確 △１一玉(22)
# >>     1 ▲     ▲１三金打
# >>     2 △         △１一玉(22)
# >>     3 ▲             -39960
# >>     1 ▲     [<▲１三金打>, <△１一玉(22)>]
# >>     1 ▲     ★確 ▲１三金打
# >>     0 △ ★確 △２二玉(12)
# >> #ROOT ▲２三金打
# >>     0 △ △２三玉(12)
# >>     1 ▲     ▲１三歩成(14)
# >>     2 △         △２四玉(23)
# >>     3 ▲             -38800
# >>     2 △         △１三玉(23)
# >>     3 ▲             -40105
# >>     2 △         △１三玉(23)
# >>     3 ▲             -40105
# >>     2 △         [<△１三玉(23)>]
# >>     2 △         ★確 △１三玉(23)
# >>     1 ▲     ▲２二金打
# >>     2 △         △１四玉(23)
# >>     3 ▲             -40165
# >>     1 ▲     [<▲２二金打>, <△１四玉(23)>]
# >>     1 ▲     ▲１三金打
# >>     2 △         △２四玉(23)
# >>     3 ▲             -39960
# >>     2 △         ★確 △２四玉(23)
# >>     1 ▲     ▲１三金打
# >>     2 △         △２四玉(23)
# >>     3 ▲             -39960
# >>     1 ▲     [<▲１三金打>, <△２四玉(23)>]
# >>     1 ▲     ▲２四金打
# >>     2 △         △２四玉(23)
# >>     3 ▲             -42420
# >>     1 ▲     [<▲２四金打>, <△２四玉(23)>]
# >>     1 ▲     ★確 ▲１三金打
# >>     0 △ △１一玉(12)
# >>     1 ▲     ▲２二金(23)
# >>     2 △         △２二玉(11)
# >>     3 ▲             -39900
# >>     2 △         ★確 △２二玉(11)
# >>     0 △ [<△１一玉(12)>, <▲２二金(23)>, <△２二玉(11)>]
# >>     0 △ △２一玉(12)
# >>     1 ▲     ▲２二金(23)
# >>     2 △         △２二玉(21)
# >>     3 ▲             -39900
# >>     2 △         ★確 △２二玉(21)
# >>     0 △ [<△２一玉(12)>, <▲２二金(23)>, <△２二玉(21)>]
# >>     0 △ ★確 △２三玉(12)
# >> #ROOT ▲１三金打
# >>     0 △ △１一玉(12)
# >>     1 ▲     ▲２二金(13)
# >>     2 △         △２二玉(11)
# >>     3 ▲             -39900
# >>     2 △         ★確 △２二玉(11)
# >>     1 ▲     ▲１二金(13)
# >>     2 △         △１二玉(11)
# >>     3 ▲             -39900
# >>     1 ▲     [<▲１二金(13)>, <△１二玉(11)>]
# >>     1 ▲     ▲２一金打
# >>     2 △         △２一玉(11)
# >>     3 ▲             -39960
# >>     1 ▲     [<▲２一金打>, <△２一玉(11)>]
# >>     1 ▲     ▲２二金打
# >>     2 △         ★確 (詰み2)
# >>     1 ▲     ▲２二金打
# >>     2 △         ★確 (詰み2)
# >>     1 ▲     [<▲２二金打>, "(詰み2)"]
# >>     1 ▲     ▲１二金打
# >>     2 △         ★確 (詰み2)
# >>     1 ▲     [<▲１二金打>, "(詰み2)"]
# >>     1 ▲     ★確 ▲２二金打
# >>     0 △ △２一玉(12)
# >>     1 ▲     ▲２二金(13)
# >>     2 △         △２二玉(21)
# >>     3 ▲             -39900
# >>     1 ▲     ▲１二金(13)
# >>     2 △         △１二玉(21)
# >>     3 ▲             -39900
# >>     1 ▲     [<▲１二金(13)>, <△１二玉(21)>]
# >>     1 ▲     ▲１一金打
# >>     2 △         △１一玉(21)
# >>     3 ▲             -39960
# >>     1 ▲     [<▲１一金打>, <△１一玉(21)>]
# >>     1 ▲     ▲２二金打
# >>     2 △         ★確 (詰み2)
# >>     0 △ [<△２一玉(12)>, <▲２二金打>, "(詰み2)"]
# >>     0 △ ★確 △１一玉(12)
# >> |------+----------------+--------------------------------------+--------+------------+----------|
# >> | 順位 | 候補手         | 読み筋                               | ▲形勢 | 評価局面数 | 処理時間 |
# >> |------+----------------+--------------------------------------+--------+------------+----------|
# >> |    1 | ▲１三金打     | △１一玉(12) ▲２二金打 (詰み2)      | 999997 |          6 | 0.013919 |
# >> |    2 | ▲２二金打     | △２二玉(12) ▲１三金打 △１一玉(22) | -39960 |         12 | 0.015538 |
# >> |    3 | ▲２三金打     | △２三玉(12) ▲１三金打 △２四玉(23) | -39960 |          9 | 0.017153 |
# >> |    4 | ▲１三歩成(14) | △１三玉(12) ▲１二金打 △１二玉(13) | -40105 |         11 | 0.013001 |
# >> |    5 | ▲１三歩(14)   | △１三玉(12) ▲１二金打 △１二玉(13) | -40105 |         17 | 0.023068 |
# >> |    6 | ▲１一金打     | △１一玉(12) ▲２一金打 △２一玉(11) | -42420 |         22 | 0.027706 |
# >> |------+----------------+--------------------------------------+--------+------------+----------|
