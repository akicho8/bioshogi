require "./example_helper"

info = Bioshogi::Parser.parse(Pathname("katomomo.ki2"))

out = ""
out << info.header.collect { |key, value| "#{key}：#{value}\n" }.join
# puts info
mediator = Mediator.new
mediator.placement_from_preset(info.header["手合割"])
info.move_infos.each do |info|
  mediator.execute(info[:input])
  # puts "-------------------------------------------"
  # puts info[:mov]
  # puts mediator
end
out << "手数----指手---------消費時間--\n"
out << mediator.to_kif_a.collect.with_index(1).collect {|e, i| "#{i} #{e} (00:00/00:00:00)\n" }.join
out << "#{mediator.to_kif_a.size.next} 投了\n"
puts out
# >> 開始日時：2017/11/11 10:00:00
# >> 終了日時：2017/11/11 17:22:00
# >> 棋戦：女流王座戦
# >> 場所：大阪・芝苑
# >> 手合割：平手
# >> 先手：加藤桃子 女王
# >> 後手：里見香奈 女流王座
# >> 戦型：ゴキゲン中飛車
# >> 手数----指手---------消費時間--
# >> 1 ２六歩(27) (00:00/00:00:00)
# >> 2 ３四歩(33) (00:00/00:00:00)
# >> 3 ２五歩(26) (00:00/00:00:00)
# >> 4 ３三角(22) (00:00/00:00:00)
# >> 5 ７六歩(77) (00:00/00:00:00)
# >> 6 ４二銀(31) (00:00/00:00:00)
# >> 7 ４八銀(39) (00:00/00:00:00)
# >> 8 ５四歩(53) (00:00/00:00:00)
# >> 9 ６八玉(59) (00:00/00:00:00)
# >> 10 ５五歩(54) (00:00/00:00:00)
# >> 11 ３六歩(37) (00:00/00:00:00)
# >> 12 ５二飛(82) (00:00/00:00:00)
# >> 13 ３七銀(48) (00:00/00:00:00)
# >> 14 ５三銀(42) (00:00/00:00:00)
# >> 15 ４六銀(37) (00:00/00:00:00)
# >> 16 ４四銀(53) (00:00/00:00:00)
# >> 17 ５八金(49) (00:00/00:00:00)
# >> 18 ６二玉(51) (00:00/00:00:00)
# >> 19 ７八玉(68) (00:00/00:00:00)
# >> 20 ７二玉(62) (00:00/00:00:00)
# >> 21 ６六歩(67) (00:00/00:00:00)
# >> 22 ８二玉(72) (00:00/00:00:00)
# >> 23 ６七金(58) (00:00/00:00:00)
# >> 24 ７二銀(71) (00:00/00:00:00)
# >> 25 ７七角(88) (00:00/00:00:00)
# >> 26 ９四歩(93) (00:00/00:00:00)
# >> 27 ８八玉(78) (00:00/00:00:00)
# >> 28 ９五歩(94) (00:00/00:00:00)
# >> 29 ９八香(99) (00:00/00:00:00)
# >> 30 ８四歩(83) (00:00/00:00:00)
# >> 31 ９九玉(88) (00:00/00:00:00)
# >> 32 ８三銀(72) (00:00/00:00:00)
# >> 33 ８八銀(79) (00:00/00:00:00)
# >> 34 ７二金(61) (00:00/00:00:00)
# >> 35 ６五歩(66) (00:00/00:00:00)
# >> 36 ７四歩(73) (00:00/00:00:00)
# >> 37 ６六金(67) (00:00/00:00:00)
# >> 38 ７三桂(81) (00:00/00:00:00)
# >> 39 ８六角(77) (00:00/00:00:00)
# >> 40 ５一飛(52) (00:00/00:00:00)
# >> 41 ７八飛(28) (00:00/00:00:00)
# >> 42 ８五歩(84) (00:00/00:00:00)
# >> 43 ５九角(86) (00:00/00:00:00)
# >> 44 ４二角(33) (00:00/00:00:00)
# >> 45 ７九金(69) (00:00/00:00:00)
# >> 46 ３三桂(21) (00:00/00:00:00)
# >> 47 ７五歩(76) (00:00/00:00:00)
# >> 48 ７五歩(74) (00:00/00:00:00)
# >> 49 ７五金(66) (00:00/00:00:00)
# >> 50 ７五角(42) (00:00/00:00:00)
# >> 51 ７五飛(78) (00:00/00:00:00)
# >> 52 ７四歩打 (00:00/00:00:00)
# >> 53 ７六飛(75) (00:00/00:00:00)
# >> 54 ７五金打 (00:00/00:00:00)
# >> 55 ７八飛(76) (00:00/00:00:00)
# >> 56 ５六歩(55) (00:00/00:00:00)
# >> 57 ５六歩(57) (00:00/00:00:00)
# >> 58 ６五金(75) (00:00/00:00:00)
# >> 59 ５五歩(56) (00:00/00:00:00)
# >> 60 ５六歩打 (00:00/00:00:00)
# >> 61 ２六角(59) (00:00/00:00:00)
# >> 62 １四歩(13) (00:00/00:00:00)
# >> 63 ６二歩打 (00:00/00:00:00)
# >> 64 ５二金(41) (00:00/00:00:00)
# >> 65 ６一歩成(62) (00:00/00:00:00)
# >> 66 ６一飛(51) (00:00/00:00:00)
# >> 67 ５四歩(55) (00:00/00:00:00)
# >> 68 ６六金(65) (00:00/00:00:00)
# >> 69 ６八飛(78) (00:00/00:00:00)
# >> 70 ７六金(66) (00:00/00:00:00)
# >> 71 ７七歩打 (00:00/00:00:00)
# >> 72 ７五金(76) (00:00/00:00:00)
# >> 73 ５八飛(68) (00:00/00:00:00)
# >> 74 ６六金(75) (00:00/00:00:00)
# >> 75 ６八飛(58) (00:00/00:00:00)
# >> 76 ６五金(66) (00:00/00:00:00)
# >> 77 ３二角打 (00:00/00:00:00)
# >> 78 ８六歩(85) (00:00/00:00:00)
# >> 79 ８六歩(87) (00:00/00:00:00)
# >> 80 ３五歩(34) (00:00/00:00:00)
# >> 81 ２三角成(32) (00:00/00:00:00)
# >> 82 ６四歩(63) (00:00/00:00:00)
# >> 83 ３五歩(36) (00:00/00:00:00)
# >> 84 ２一飛(61) (00:00/00:00:00)
# >> 85 ３四馬(23) (00:00/00:00:00)
# >> 86 ９二香(91) (00:00/00:00:00)
# >> 87 ４八角(26) (00:00/00:00:00)
# >> 88 ９一飛(21) (00:00/00:00:00)
# >> 89 ２四歩(25) (00:00/00:00:00)
# >> 90 ７五金(65) (00:00/00:00:00)
# >> 91 ５六馬(34) (00:00/00:00:00)
# >> 92 ８四歩打 (00:00/00:00:00)
# >> 93 ７五角(48) (00:00/00:00:00)
# >> 94 ７五歩(74) (00:00/00:00:00)
# >> 95 ６四飛(68) (00:00/00:00:00)
# >> 96 ６三金(52) (00:00/00:00:00)
# >> 97 ６八飛(64) (00:00/00:00:00)
# >> 98 ６五角打 (00:00/00:00:00)
# >> 99 ６五飛(68) (00:00/00:00:00)
# >> 100 ６五桂(73) (00:00/00:00:00)
# >> 101 ６五馬(56) (00:00/00:00:00)
# >> 102 ５九飛打 (00:00/00:00:00)
# >> 103 ６六桂打 (00:00/00:00:00)
# >> 104 ７三金(72) (00:00/00:00:00)
# >> 105 ５二角打 (00:00/00:00:00)
# >> 106 ６四金(63) (00:00/00:00:00)
# >> 107 ６四馬(65) (00:00/00:00:00)
# >> 108 ６四金(73) (00:00/00:00:00)
# >> 109 ６五歩打 (00:00/00:00:00)
# >> 110 ４八角打 (00:00/00:00:00)
# >> 111 ６四歩(65) (00:00/00:00:00)
# >> 112 ６六角成(48) (00:00/00:00:00)
# >> 113 ７三金打 (00:00/00:00:00)
# >> 114 投了
