require "./setup"

# Bioshogi.logger = ActiveSupport::TaggedLogging.new(ActiveSupport::Logger.new(STDOUT))

Board.dimensiton_change([2, 5])
[
  Diver::NegaAlphaDiver,
  Diver::NegaScoutDiver,
].each do |diver_class|
  container = Container::Basic.new
  container.board.placement_from_shape <<~EOT
  +------+
  | ・v香|
  | ・v飛|
  | ・v歩|
  | ・ 飛|
  | ・ 香|
  +------+
    EOT
  brain = container.player_at(:black).brain(diver_class: diver_class)
  tp brain.iterative_deepening(depth_max_range: 0..0) # => [{:hand=><▲１三飛成(14)>, :score=>305, :black_side_score=>305, :best_pv=>[], :eval_times=>1, :sec=>7.5e-05, :other=>[]}, {:hand=><▲２四飛(14)>, :score=>-100, :black_side_score=>-100, :best_pv=>[], :eval_times=>1, :sec=>3.0e-05, :other=>[]}], [{:hand=><▲１三飛成(14)>, :score=>305, :black_side_score=>305, :best_pv=>[], :eval_times=>1, :sec=>2.9e-05, :other=>[]}, {:hand=><▲２四飛(14)>, :score=>-100, :black_side_score=>-100, :best_pv=>[], :eval_times=>1, :sec=>2.3e-05, :other=>[]}]
  tp brain.iterative_deepening(depth_max_range: 0..1) # => [{:hand=><▲２四飛(14)>, :score=>-1200, :black_side_score=>-1200, :best_pv=>[<△１四歩成(13)>], :eval_times=>2, :sec=>0.000296, :other=>[]}, {:hand=><▲１三飛成(14)>, :score=>-4195, :black_side_score=>-4195, :best_pv=>[<△１三飛成(12)>], :eval_times=>2, :sec=>0.000331, :other=>[]}], [{:hand=><▲２四飛(14)>, :score=>-1200, :black_side_score=>-1200, :best_pv=>[<△１四歩成(13)>], :eval_times=>3, :sec=>0.000459, :other=>[]}, {:hand=><▲１三飛成(14)>, :score=>-4195, :black_side_score=>-4195, :best_pv=>[<△１三飛成(12)>], :eval_times=>2, :sec=>0.000443, :other=>[]}]
  tp brain.iterative_deepening(depth_max_range: 0..2) # => [{:hand=><▲１三飛成(14)>, :score=>705, :black_side_score=>705, :best_pv=>[<△１三飛成(12)>, <▲１三香成(15)>], :eval_times=>10, :sec=>0.001576, :other=>[]}, {:hand=><▲２四飛(14)>, :score=>105, :black_side_score=>105, :best_pv=>[<△１四歩成(13)>, <▲１四香(15)>], :eval_times=>12, :sec=>0.001552, :other=>[]}], [{:hand=><▲１三飛成(14)>, :score=>705, :black_side_score=>705, :best_pv=>[<△１三飛成(12)>, <▲１三香成(15)>], :eval_times=>11, :sec=>0.002705, :other=>[]}, {:hand=><▲２四飛(14)>, :score=>105, :black_side_score=>105, :best_pv=>[<△１四歩成(13)>, <▲１四香(15)>], :eval_times=>15, :sec=>0.004912, :other=>[]}]
  tp brain.iterative_deepening(depth_max_range: 0..3) # => [{:hand=><▲２四飛(14)>, :score=>-1325, :black_side_score=>-1325, :best_pv=>[<△１四歩成(13)>, <▲１四香(15)>, <△１四飛成(12)>], :eval_times=>30, :sec=>0.004068, :other=>[]}, {:hand=><▲１三飛成(14)>, :score=>-1725, :black_side_score=>-1725, :best_pv=>[<△１三飛成(12)>, <▲１三香成(15)>, <△１三香成(11)>], :eval_times=>40, :sec=>0.006978, :other=>[]}], [{:hand=><▲２四飛(14)>, :score=>-1325, :black_side_score=>-1325, :best_pv=>[<△１四歩成(13)>, <▲１四香(15)>, <△１四飛成(12)>], :eval_times=>45, :sec=>0.016298, :other=>[]}, {:hand=><▲１三飛成(14)>, :score=>-1725, :black_side_score=>-1725, :best_pv=>[<△１三飛成(12)>, <▲１三香成(15)>, <△１三香成(11)>], :eval_times=>38, :sec=>0.010426, :other=>[]}]
  tp brain.iterative_deepening(depth_max_range: 0..4) # => [{:hand=><▲２四飛(14)>, :score=>2975, :black_side_score=>2975, :best_pv=>[<△１四歩成(13)>, <▲１四香(15)>, <△１四飛成(12)>, <▲１四飛(24)>], :eval_times=>154, :sec=>0.017915, :other=>[]}, {:hand=><▲１三飛成(14)>, :score=>-1730, :black_side_score=>-1730, :best_pv=>[<△１三飛成(12)>, <▲１三香成(15)>, <△１三香成(11)>, <▲２二歩打>], :eval_times=>135, :sec=>0.017119, :other=>[]}], [{:hand=><▲２四飛(14)>, :score=>2975, :black_side_score=>2975, :best_pv=>[<△１四歩成(13)>, <▲１四香(15)>, <△１四飛成(12)>, <▲１四飛(24)>], :eval_times=>185, :sec=>0.058562, :other=>[]}, {:hand=><▲１三飛成(14)>, :score=>-1730, :black_side_score=>-1730, :best_pv=>[<△１三飛成(12)>, <▲１三香成(15)>, <△１三香成(11)>, <▲２二歩打>], :eval_times=>140, :sec=>0.054615, :other=>[]}]
end
# >> |----------------+-------+--------+---------+------------+---------+-------|
# >> | hand           | score | score2 | best_pv | eval_times | sec     | other |
# >> |----------------+-------+--------+---------+------------+---------+-------|
# >> | ▲１三飛成(14) |   305 |    305 | []      |          1 | 7.5e-05 | []    |
# >> | ▲２四飛(14)   |  -100 |   -100 | []      |          1 | 3.0e-05 | []    |
# >> |----------------+-------+--------+---------+------------+---------+-------|
# >> |----------------+-------+--------+--------------------+------------+----------+-------|
# >> | hand           | score | score2 | best_pv            | eval_times | sec      | other |
# >> |----------------+-------+--------+--------------------+------------+----------+-------|
# >> | ▲２四飛(14)   | -1200 |  -1200 | [<△１四歩成(13)>] |          2 | 0.000296 | []    |
# >> | ▲１三飛成(14) | -4195 |  -4195 | [<△１三飛成(12)>] |          2 | 0.000331 | []    |
# >> |----------------+-------+--------+--------------------+------------+----------+-------|
# >> |----------------+-------+--------+--------------------------------------+------------+----------+-------|
# >> | hand           | score | score2 | best_pv                              | eval_times | sec      | other |
# >> |----------------+-------+--------+--------------------------------------+------------+----------+-------|
# >> | ▲１三飛成(14) |   705 |    705 | [<△１三飛成(12)>, <▲１三香成(15)>] |         10 | 0.001576 | []    |
# >> | ▲２四飛(14)   |   105 |    105 | [<△１四歩成(13)>, <▲１四香(15)>]   |         12 | 0.001552 | []    |
# >> |----------------+-------+--------+--------------------------------------+------------+----------+-------|
# >> |----------------+-------+--------+--------------------------------------------------------+------------+----------+-------|
# >> | hand           | score | score2 | best_pv                                                | eval_times | sec      | other |
# >> |----------------+-------+--------+--------------------------------------------------------+------------+----------+-------|
# >> | ▲２四飛(14)   | -1325 |  -1325 | [<△１四歩成(13)>, <▲１四香(15)>, <△１四飛成(12)>]   |         30 | 0.004068 | []    |
# >> | ▲１三飛成(14) | -1725 |  -1725 | [<△１三飛成(12)>, <▲１三香成(15)>, <△１三香成(11)>] |         40 | 0.006978 | []    |
# >> |----------------+-------+--------+--------------------------------------------------------+------------+----------+-------|
# >> |----------------+-------+--------+----------------------------------------------------------------------+------------+----------+-------|
# >> | hand           | score | score2 | best_pv                                                              | eval_times | sec      | other |
# >> |----------------+-------+--------+----------------------------------------------------------------------+------------+----------+-------|
# >> | ▲２四飛(14)   |  2975 |   2975 | [<△１四歩成(13)>, <▲１四香(15)>, <△１四飛成(12)>, <▲１四飛(24)>] |        154 | 0.017915 | []    |
# >> | ▲１三飛成(14) | -1730 |  -1730 | [<△１三飛成(12)>, <▲１三香成(15)>, <△１三香成(11)>, <▲２二歩打>] |        135 | 0.017119 | []    |
# >> |----------------+-------+--------+----------------------------------------------------------------------+------------+----------+-------|
# >> |----------------+-------+--------+---------+------------+---------+-------|
# >> | hand           | score | score2 | best_pv | eval_times | sec     | other |
# >> |----------------+-------+--------+---------+------------+---------+-------|
# >> | ▲１三飛成(14) |   305 |    305 | []      |          1 | 2.9e-05 | []    |
# >> | ▲２四飛(14)   |  -100 |   -100 | []      |          1 | 2.3e-05 | []    |
# >> |----------------+-------+--------+---------+------------+---------+-------|
# >> |----------------+-------+--------+--------------------+------------+----------+-------|
# >> | hand           | score | score2 | best_pv            | eval_times | sec      | other |
# >> |----------------+-------+--------+--------------------+------------+----------+-------|
# >> | ▲２四飛(14)   | -1200 |  -1200 | [<△１四歩成(13)>] |          3 | 0.000459 | []    |
# >> | ▲１三飛成(14) | -4195 |  -4195 | [<△１三飛成(12)>] |          2 | 0.000443 | []    |
# >> |----------------+-------+--------+--------------------+------------+----------+-------|
# >> |----------------+-------+--------+--------------------------------------+------------+----------+-------|
# >> | hand           | score | score2 | best_pv                              | eval_times | sec      | other |
# >> |----------------+-------+--------+--------------------------------------+------------+----------+-------|
# >> | ▲１三飛成(14) |   705 |    705 | [<△１三飛成(12)>, <▲１三香成(15)>] |         11 | 0.002705 | []    |
# >> | ▲２四飛(14)   |   105 |    105 | [<△１四歩成(13)>, <▲１四香(15)>]   |         15 | 0.004912 | []    |
# >> |----------------+-------+--------+--------------------------------------+------------+----------+-------|
# >> |----------------+-------+--------+--------------------------------------------------------+------------+----------+-------|
# >> | hand           | score | score2 | best_pv                                                | eval_times | sec      | other |
# >> |----------------+-------+--------+--------------------------------------------------------+------------+----------+-------|
# >> | ▲２四飛(14)   | -1325 |  -1325 | [<△１四歩成(13)>, <▲１四香(15)>, <△１四飛成(12)>]   |         45 | 0.016298 | []    |
# >> | ▲１三飛成(14) | -1725 |  -1725 | [<△１三飛成(12)>, <▲１三香成(15)>, <△１三香成(11)>] |         38 | 0.010426 | []    |
# >> |----------------+-------+--------+--------------------------------------------------------+------------+----------+-------|
# >> |----------------+-------+--------+----------------------------------------------------------------------+------------+----------+-------|
# >> | hand           | score | score2 | best_pv                                                              | eval_times | sec      | other |
# >> |----------------+-------+--------+----------------------------------------------------------------------+------------+----------+-------|
# >> | ▲２四飛(14)   |  2975 |   2975 | [<△１四歩成(13)>, <▲１四香(15)>, <△１四飛成(12)>, <▲１四飛(24)>] |        185 | 0.058562 | []    |
# >> | ▲１三飛成(14) | -1730 |  -1730 | [<△１三飛成(12)>, <▲１三香成(15)>, <△１三香成(11)>, <▲２二歩打>] |        140 | 0.054615 | []    |
# >> |----------------+-------+--------+----------------------------------------------------------------------+------------+----------+-------|
