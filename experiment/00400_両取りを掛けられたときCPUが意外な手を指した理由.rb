require "./example_helper"

# 両取りをかけられた状態で馬を切ったCPUの考え方
#
# |--------+-------+------------------------------------------------+-------|
# | 手     | score | 内訳                                           |  差分 |
# |--------+-------+------------------------------------------------+-------|
# | ▲71馬 | +3250 | 銀入手(+1050) 相手の銀消滅(+1000) 角成り(+200) | +2250 |
# | △同玉 |  -640 | 盤上の馬が消える(-2000)、馬を入手される(-1890) | -3890 |
# |--------+-------+------------------------------------------------+-------|
#
# |--------+-------+--------------------------------------------------+-------|
# | 手     | score | 内訳                                             | 差分  |
# |--------+-------+--------------------------------------------------+-------|
# | ▲42馬 | +1200 | 角成り(+200)                                     | +200  |
# | △79馬 | -1050 | 銀損失(-1000) 相手に銀が渡る(-1050) 角成り(-200) | -2250 |
# |--------+-------+--------------------------------------------------+-------|
#
# ここからわかるのは、何を指しても損するから損を最小限にする手を指したということ。
# 理想は▲42馬(+1200)だが、相手の手番で銀を必ず取られ -1050 になるのなら馬を切って -640 程度になる方を選んだ。
# 人間的には違和感のある手だけど一貫性のある考え方で、ある意味、両取り逃げるべからずを実践した手だった。

mediator = Mediator.new
mediator.placement_from_bod <<~EOT
後手の持駒：
  ９ ８ ７ ６ ５ ４ ３ ２ １
+---------------------------+
| ・ ・v銀v玉 ・ ・ ・ ・ ・|一
| ・ ・ ・ ・ ・ ・ ・ ・ ・|二
| ・ ・ ・ ・ 角 ・ ・ ・ ・|三
| ・ ・ ・ ・ ・ ・ ・ ・ ・|四
| ・ ・ ・ ・ ・ ・ ・ ・ ・|五
| ・ ・ ・ ・ ・ ・ ・ ・ ・|六
| ・ ・ ・ ・v角 ・ ・ ・ ・|七
| ・ ・ ・ ・ ・ ・ ・ ・ ・|八
| ・ ・ 銀 ・ 玉 ・ 銀 ・ ・|九
+---------------------------+
先手の持駒：
EOT
puts mediator
tp mediator.player_at(:black).evaluator.detail_score
mediator.player_at(:black).evaluator.score # => 1000

mediator = Mediator.new
mediator.placement_from_bod <<~EOT
後手の持駒：
  ９ ８ ７ ６ ５ ４ ３ ２ １
+---------------------------+
| ・ ・ 馬v玉 ・ ・ ・ ・ ・|一
| ・ ・ ・ ・ ・ ・ ・ ・ ・|二
| ・ ・ ・ ・ ・ ・ ・ ・ ・|三
| ・ ・ ・ ・ ・ ・ ・ ・ ・|四
| ・ ・ ・ ・ ・ ・ ・ ・ ・|五
| ・ ・ ・ ・ ・ ・ ・ ・ ・|六
| ・ ・ ・ ・v角 ・ ・ ・ ・|七
| ・ ・ ・ ・ ・ ・ ・ ・ ・|八
| ・ ・ 銀 ・ 玉 ・ 銀 ・ ・|九
+---------------------------+
先手の持駒：銀
EOT
puts mediator
tp mediator.player_at(:black).evaluator.detail_score
mediator.player_at(:black).evaluator.score # => 3250

mediator = Mediator.new
mediator.placement_from_bod <<~EOT
後手の持駒：角
  ９ ８ ７ ６ ５ ４ ３ ２ １
+---------------------------+
| ・ ・v玉 ・ ・ ・ ・ ・ ・|一
| ・ ・ ・ ・ ・ ・ ・ ・ ・|二
| ・ ・ ・ ・ ・ ・ ・ ・ ・|三
| ・ ・ ・ ・ ・ ・ ・ ・ ・|四
| ・ ・ ・ ・ ・ ・ ・ ・ ・|五
| ・ ・ ・ ・ ・ ・ ・ ・ ・|六
| ・ ・ ・ ・v角 ・ ・ ・ ・|七
| ・ ・ ・ ・ ・ ・ ・ ・ ・|八
| ・ ・ 銀 ・ 玉 ・ 銀 ・ ・|九
+---------------------------+
先手の持駒：銀
EOT
puts mediator
tp mediator.player_at(:black).evaluator.detail_score
mediator.player_at(:black).evaluator.score # => -640

mediator = Mediator.new
mediator.placement_from_bod <<~EOT
後手の持駒：
  ９ ８ ７ ６ ５ ４ ３ ２ １
+---------------------------+
| ・ ・v銀v玉 ・ ・ ・ ・ ・|一
| ・ ・ ・ ・ ・ 馬 ・ ・ ・|二
| ・ ・ ・ ・ ・ ・ ・ ・ ・|三
| ・ ・ ・ ・ ・ ・ ・ ・ ・|四
| ・ ・ ・ ・ ・ ・ ・ ・ ・|五
| ・ ・ ・ ・ ・ ・ ・ ・ ・|六
| ・ ・ ・ ・v角 ・ ・ ・ ・|七
| ・ ・ ・ ・ ・ ・ ・ ・ ・|八
| ・ ・ 銀 ・ 玉 ・ 銀 ・ ・|九
+---------------------------+
先手の持駒：
EOT
puts mediator
tp mediator.player_at(:black).evaluator.detail_score
mediator.player_at(:black).evaluator.score # => 1200

mediator = Mediator.new
mediator.placement_from_bod <<~EOT
後手の持駒：銀
  ９ ８ ７ ６ ５ ４ ３ ２ １
+---------------------------+
| ・ ・v銀v玉 ・ ・ ・ ・ ・|一
| ・ ・ ・ ・ ・ 馬 ・ ・ ・|二
| ・ ・ ・ ・ ・ ・ ・ ・ ・|三
| ・ ・ ・ ・ ・ ・ ・ ・ ・|四
| ・ ・ ・ ・ ・ ・ ・ ・ ・|五
| ・ ・ ・ ・ ・ ・ ・ ・ ・|六
| ・ ・ ・ ・ ・ ・ ・ ・ ・|七
| ・ ・ ・ ・ ・ ・ ・ ・ ・|八
| ・ ・v馬 ・ 玉 ・ 銀 ・ ・|九
+---------------------------+
先手の持駒：
EOT
puts mediator
tp mediator.player_at(:black).evaluator.detail_score
mediator.player_at(:black).evaluator.score # => -1050

# >> 後手の持駒：なし
# >>   ９ ８ ７ ６ ５ ４ ３ ２ １
# >> +---------------------------+
# >> | ・ ・v銀v玉 ・ ・ ・ ・ ・|一
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|二
# >> | ・ ・ ・ ・ 角 ・ ・ ・ ・|三
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|四
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|五
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|六
# >> | ・ ・ ・ ・v角 ・ ・ ・ ・|七
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|八
# >> | ・ ・ 銀 ・ 玉 ・ 銀 ・ ・|九
# >> +---------------------------+
# >> 先手の持駒：なし
# >> 手数＝0 まで
# >> 
# >> 先手番
# >> |----------+-------+--------+--------|
# >> | piece    | count | weight | total  |
# >> |----------+-------+--------+--------|
# >> | ▲５三角 |     1 |   1800 |   1800 |
# >> | ▲７九銀 |     1 |   1000 |   1000 |
# >> | ▲５九玉 |     1 |  40000 |  40000 |
# >> | ▲３九銀 |     1 |   1000 |   1000 |
# >> | △７一銀 |     1 |   1000 |  -1000 |
# >> | △６一玉 |     1 |  40000 | -40000 |
# >> | △５七角 |     1 |   1800 |  -1800 |
# >> |          |       |        |   1000 |
# >> |----------+-------+--------+--------|
# >> 後手の持駒：なし
# >>   ９ ８ ７ ６ ５ ４ ３ ２ １
# >> +---------------------------+
# >> | ・ ・ 馬v玉 ・ ・ ・ ・ ・|一
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|二
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|三
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|四
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|五
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|六
# >> | ・ ・ ・ ・v角 ・ ・ ・ ・|七
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|八
# >> | ・ ・ 銀 ・ 玉 ・ 銀 ・ ・|九
# >> +---------------------------+
# >> 先手の持駒：銀
# >> 手数＝0 まで
# >> 
# >> 先手番
# >> |----------+-------+--------+--------|
# >> | piece    | count | weight | total  |
# >> |----------+-------+--------+--------|
# >> | ▲７一馬 |     1 |   2000 |   2000 |
# >> | ▲７九銀 |     1 |   1000 |   1000 |
# >> | ▲５九玉 |     1 |  40000 |  40000 |
# >> | ▲３九銀 |     1 |   1000 |   1000 |
# >> | 銀       |     1 |   1050 |   1050 |
# >> | △６一玉 |     1 |  40000 | -40000 |
# >> | △５七角 |     1 |   1800 |  -1800 |
# >> |          |       |        |   3250 |
# >> |----------+-------+--------+--------|
# >> 後手の持駒：角
# >>   ９ ８ ７ ６ ５ ４ ３ ２ １
# >> +---------------------------+
# >> | ・ ・v玉 ・ ・ ・ ・ ・ ・|一
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|二
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|三
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|四
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|五
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|六
# >> | ・ ・ ・ ・v角 ・ ・ ・ ・|七
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|八
# >> | ・ ・ 銀 ・ 玉 ・ 銀 ・ ・|九
# >> +---------------------------+
# >> 先手の持駒：銀
# >> 手数＝0 まで
# >> 
# >> 先手番
# >> |----------+-------+--------+--------|
# >> | piece    | count | weight | total  |
# >> |----------+-------+--------+--------|
# >> | ▲７九銀 |     1 |   1000 |   1000 |
# >> | ▲５九玉 |     1 |  40000 |  40000 |
# >> | ▲３九銀 |     1 |   1000 |   1000 |
# >> | 銀       |     1 |   1050 |   1050 |
# >> | △７一玉 |     1 |  40000 | -40000 |
# >> | △５七角 |     1 |   1800 |  -1800 |
# >> | 角       |     1 |   1890 |  -1890 |
# >> |          |       |        |   -640 |
# >> |----------+-------+--------+--------|
# >> 後手の持駒：なし
# >>   ９ ８ ７ ６ ５ ４ ３ ２ １
# >> +---------------------------+
# >> | ・ ・v銀v玉 ・ ・ ・ ・ ・|一
# >> | ・ ・ ・ ・ ・ 馬 ・ ・ ・|二
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|三
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|四
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|五
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|六
# >> | ・ ・ ・ ・v角 ・ ・ ・ ・|七
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|八
# >> | ・ ・ 銀 ・ 玉 ・ 銀 ・ ・|九
# >> +---------------------------+
# >> 先手の持駒：なし
# >> 手数＝0 まで
# >> 
# >> 先手番
# >> |----------+-------+--------+--------|
# >> | piece    | count | weight | total  |
# >> |----------+-------+--------+--------|
# >> | ▲４二馬 |     1 |   2000 |   2000 |
# >> | ▲７九銀 |     1 |   1000 |   1000 |
# >> | ▲５九玉 |     1 |  40000 |  40000 |
# >> | ▲３九銀 |     1 |   1000 |   1000 |
# >> | △７一銀 |     1 |   1000 |  -1000 |
# >> | △６一玉 |     1 |  40000 | -40000 |
# >> | △５七角 |     1 |   1800 |  -1800 |
# >> |          |       |        |   1200 |
# >> |----------+-------+--------+--------|
# >> 後手の持駒：銀
# >>   ９ ８ ７ ６ ５ ４ ３ ２ １
# >> +---------------------------+
# >> | ・ ・v銀v玉 ・ ・ ・ ・ ・|一
# >> | ・ ・ ・ ・ ・ 馬 ・ ・ ・|二
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|三
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|四
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|五
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|六
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|七
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|八
# >> | ・ ・v馬 ・ 玉 ・ 銀 ・ ・|九
# >> +---------------------------+
# >> 先手の持駒：なし
# >> 手数＝0 まで
# >> 
# >> 先手番
# >> |----------+-------+--------+--------|
# >> | piece    | count | weight | total  |
# >> |----------+-------+--------+--------|
# >> | ▲４二馬 |     1 |   2000 |   2000 |
# >> | ▲５九玉 |     1 |  40000 |  40000 |
# >> | ▲３九銀 |     1 |   1000 |   1000 |
# >> | △７一銀 |     1 |   1000 |  -1000 |
# >> | △６一玉 |     1 |  40000 | -40000 |
# >> | △７九馬 |     1 |   2000 |  -2000 |
# >> | 銀       |     1 |   1050 |  -1050 |
# >> |          |       |        |  -1050 |
# >> |----------+-------+--------+--------|
