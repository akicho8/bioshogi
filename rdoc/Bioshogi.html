<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>module Bioshogi - RDoc Documentation</title>

  <meta name="keywords" content="ruby,module,Bioshogi">

    <meta name="description" content="module Bioshogi: CounterHash. Parser.">

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
  var index_rel_prefix = "./";
</script>

<script src="./js/navigation.js" defer></script>
<script src="./js/search.js" defer></script>
<script src="./js/search_index.js" defer></script>
<script src="./js/searcher.js" defer></script>
<script src="./js/darkfish.js" defer></script>

<link href="./css/fonts.css" rel="stylesheet">
<link href="./css/rdoc.css" rel="stylesheet">


<body id="top" role="document" class="module">
<div id="navigation-toggle" role="button" tabindex="0" aria-label="Toggle sidebar" aria-expanded="true" aria-controls="navigation">
  <span aria-hidden="true">&#9776;</span>
</div>


<nav id="navigation" role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search (/) for a class, method, ..." spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  
  
  
  
<div id="includes-section" class="nav-section">
  <h3>Included Modules</h3>

  <ul class="link-list">
    <li><span class="include">ActiveSupport::Configurable</span>
    <li><span class="include">MemoryRecord</span>
  </ul>
</div>

  
<div id="extends-section" class="nav-section">
  <h3>Extended With Modules</h3>

  <ul class="link-list">
    <li><span class="extend">ActiveSupport::Concern</span>
  </ul>
</div>

  
  <div class="nav-section">
    <h3>Class Methods</h3>
    <ul class="link-list" role="directory">
      <li class="calls-super" ><a href="#method-c-fetch">fetch</a></li>
    </ul>
  </div>



  <div class="nav-section">
    <h3>Instance Methods</h3>
    <ul class="link-list" role="directory">
      <li ><a href="#method-i-default_params">default_params</a></li>
      <li ><a href="#method-i-hand_log">hand_log</a></li>
      <li ><a href="#method-i-inspect">inspect</a></li>
      <li ><a href="#method-i-place_same-3F">place_same?</a></li>
      <li class="calls-super" ><a href="#method-i-turn_ended_process">turn_ended_process</a></li>
    </ul>
  </div>



  <footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.10.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

</nav>

<main role="main" aria-labelledby="module-Bioshogi">
  <h1 id="module-Bioshogi" class="anchor-link module">
    module Bioshogi
  </h1>

  <section class="description">
    
<p>|——————-+————————————————————————————————-| | 属性              | 意味                                                                                            | |——————-+————————————————————————————————-| | parent            | 親を消したい場合に指定する。今のところ木構造は親を消すためだけにしかつかってない                | | related_ancestors | 木構造の予約メソッドではないが、これも normalize のときに、指定した戦法を消す。名前がいまいち。 | | group_key         | 最後にそのカテゴリーを備考に埋め込む。最後でないといけない → やめ                              | |——————-+————————————————————————————————-|</p>

<p>盤上の駒数を素早く得るための仕組み</p>

<p>駒柱判定用</p>

<p>executor メソッドに反応する (each に反応する Enumerable のように)</p>

<p>|—————–+————————————| | turn_gteq       | N手以上である                      | | hirate_like     | 平手風の開始局面から始まっている   | | critical        | 駒が衝突した (角と歩も含む)        | | outbreak        | 駒が衝突した (角と歩を除く)        | | checkmate       | 最後は詰みである                   | |—————–+————————————|</p>
<ul><li>
<p>順序重要</p>
</li><li>
<p>相や対で始まるものは関連するタグに対応して必ず決まるので他の条件は要らない</p>
</li></ul>

<p><a href="https://www.shogi-extend.com/api/swars/tag_frequency">www.shogi-extend.com/api/swars/tag_frequency</a></p>

<p>:optional: は考慮する必要があるもの。</p>

<p>戦法チェックで最適化の効果が大きい戦法ランキング</p>

<p>|——–+———————————————————————————-| | Prefix | 意味                                                                             | |——–+———————————————————————————-| | !      | プライマリーなトリガーとする。比較する必要がないため比較用の盤面情報には含めない | | @      | ! と同じだけど、盤面情報に含める(異なる駒で複数トリガーを書くとき用)             | | *      | ▲でどれかがここに含まれる                                                       | | ?      | △側でどれかがここに含まれる                                                     | | ~      | ▲側でここに含まれない                                                           | | ^      | △側でここに含まれない                                                           | |——–+———————————————————————————-|</p>

<p>|—-+——————————–| | 印 | 意味                           | |—-+——————————–| | ● | この座標に何かある             | | ○ | この座標に何もない             | | ★ | この座標のどれかが移動元       | | ☆ | この座標のどれも移動元ではない | | ◆ | この座標に自分の銀以上がある   | 一つの升に *金 *銀 *飛 *角 が指定されているのに似ている (トリガーには含まれない) | ■ | この座標に自分の銀or金がある   | 一つの升に *金 *銀 が指定されているのに似ている (トリガーには含まれない) | □ | この座標に自分の銀or金がない   | | ◇ | この座標に自分の歩以上がある   | |—-+——————————–|</p>

<p>・座標のラベルは省略可能で右上からデータを埋めていく・なので右上5x5の盤であれば5x5のサイズで記入すればよい</p>

<p>大駒の位置をO(1)で得るための履歴</p>

<p>大駒の位置をO(1)で得るための履歴</p>

<p>/Users/ikeda/src/bioshogi/lib/bioshogi/analysis/tactic_hit_turn_table_generator.rb から生成しているので編集するべからず手数が nil のものは最後に判定してるため成立した手数を正確に知ることができない</p>

<p><a href="http://www2.computer-shogi.org/protocol/record_v22.html">www2.computer-shogi.org/protocol/record_v22.html</a></p>

<pre class="ruby"><span class="ruby-identifier">９</span> <span class="ruby-identifier">８</span> <span class="ruby-identifier">７</span> <span class="ruby-identifier">６</span> <span class="ruby-identifier">５</span> <span class="ruby-identifier">４</span> <span class="ruby-identifier">３</span> <span class="ruby-identifier">２</span> <span class="ruby-identifier">１</span>
</pre>

<p><code>---------------------------</code> | ・v桂v銀v金v玉v金v銀v桂v香|一| ・v飛 ・ ・ ・ ・ ・v角 ・|二|v歩v歩v歩v歩v歩v歩v歩v歩v歩|三| ・ ・ ・ ・ ・ ・ ・ ・ ・|四| ・ ・ ・ ・ ・ ・ ・ ・ ・|五| ・ ・ ・ ・ ・ ・ ・ ・ ・|六| 歩 歩 歩 歩 歩 歩 歩 歩 歩|七| ・ 角 ・ ・ ・ ・ ・ 飛 ・|八| 香 桂 銀 金 玉 金 銀 桂 香|九<code>---------------------------</code></p>

<p>列の駒数をなるべく高速に判定する</p>

<p>h = <a href="Bioshogi/CounterHash.html#method-c-new"><code>CounterHash.new</code></a> <a href=":x">h</a>                           # =&gt; 0 h.increment(:x)                 # =&gt; 1 h.keys                          # =&gt; [:x] h.decrement(:x)                 # =&gt; 0 h.keys                          # =&gt; [] h.count                         # =&gt; 0</p>

<p>方針</p>
<ul><li>
<p>location 考慮は <a href="Bioshogi/Place.html"><code>Place</code></a> の仕事である</p>
</li><li>
<p>location を持ち込んではいけない</p>
</li><li>
<p>常に▲視点のメソッドとする</p>
</li></ul>

<p>フレームレートを指定値に変換する。指定しない場合は入力ファイルの値を継承<a href="http://mobilehackerz.jp/archive/wiki/index.php?%BA%C7%BF%B7ffmpeg%A4%CE%A5%AA%A5%D7%A5%B7%A5%E7%A5%F3%A4%DE%A4%C8%A4%E1">mobilehackerz.jp/archive/wiki/index.php?%BA%C7%BF%B7ffmpeg%A4%CE%A5%AA%A5%D7%A5%B7%A5%E7%A5%F3%A4%DE%A4%C8%A4%E1</a> 小数で指定してはいけない</p>

<p>FFMPEG でのフレームレート設定の違い<a href="https://nico-lab.net/setting_fps_with_ffmpeg">nico-lab.net/setting_fps_with_ffmpeg</a>/ 入力オプションとしての -r 入力ファイルの前に指定する。総フレーム数はそのままに1秒あたりのフレームレートを指定するので、オリジナルよりフレームレートが少なければ動画時間が長く、多ければ動画時間が短くなる。</p>

<p>ruby 0102_speed_compare.rb 7819.15000002482 9034.157999994932 -rw——- 1 ikeda staff  60K  8 16 19:16 _output0.mp4 -rw-r–r– 1 ikeda staff 119K  8 16 19:16 _output1_1.mp4 -rw-r–r– 1 ikeda staff 135K  8 16 19:17 _output1_2.mp4</p>

<p>▼ビデオビットレート関連オプション</p>

<pre>https://tech.ckme.co.jp/ffmpeg_h264.shtml
|-------------+--------+--------------------------------------------------------------------------------------------------------|
| オプション  | 初期値 | 意味                                                                                                   |
|-------------+--------+--------------------------------------------------------------------------------------------------------|
| -crf 23     | 23     | 品質固定モード。18..23 推奨。保存用なら18未満、モバイルなら24以上もあり。6減るとビットレートが倍になる |
| -b:v XXXk   | なし   | ビットレート一定モード。FullHDで25M。4kで100Mは欲しい                                                  |
| -preset xxx | medium | crf のとき使える。placebo になるほど遅いがファイルサイズが減る                                         |
| -tune       | なし   | preset のとき使える。stillimage はスライドショー用                                                     |
|-------------+--------+--------------------------------------------------------------------------------------------------------|</pre>

<p>▼確認</p>

<pre class="ruby"><span class="ruby-identifier">info</span> = <span class="ruby-constant">Bioshogi</span><span class="ruby-operator">::</span><span class="ruby-constant">Parser</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-string">&quot;position startpos moves 7g7f 8c8d 7i6h 3c3d 6h7g&quot;</span>)
<span class="ruby-identifier">bin</span> = <span class="ruby-identifier">info</span>.<span class="ruby-identifier">to_animation_mp4</span>(<span class="ruby-value">end_duration:</span> <span class="ruby-value">1</span>, <span class="ruby-value">cover_text:</span> <span class="ruby-string">&quot;x&quot;</span>, <span class="ruby-value">progress_callback:</span> <span class="ruby-operator">-&gt;</span> <span class="ruby-identifier">e</span> { <span class="ruby-identifier">puts</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">log</span> })
<span class="ruby-constant">Pathname</span>(<span class="ruby-string">&quot;_output.mp4&quot;</span>).<span class="ruby-identifier">write</span>(<span class="ruby-identifier">bin</span>)
</pre>

<p>ボリュームは上げると音割れする場合があるため基本下げて調整する</p>

<p>BGMが合っているか確認するのが目的別になくてもよい</p>

<p>進捗通知</p>

<pre>progress_cop = ProgressCop.new(5) { |e| puts e }
progress_cop.next_step(&quot;message1&quot;)
progress_cop.next_step(&quot;message2&quot;)
progress_cop.next_step(&quot;message3&quot;)

&gt;&gt; 2021-09-11 11:20:33 1/5  12.50 % T1 message1
&gt;&gt; 2021-09-11 11:20:33 2/5  25.00 % T0 message2 &lt;-- 1秒経過していない
&gt;&gt; 2021-09-11 11:20:34 3/5  37.50 % T1 message3 &lt;-- 1秒経過したので通知するべき</pre>

<p>CSA標準棋譜ファイル形式<a href="http://www.computer-shogi.org/protocol/record_v22.html">www.computer-shogi.org/protocol/record_v22.html</a> ← 見れなくなった<a href="http://www2.computer-shogi.org/protocol/tcp_ip_server_121.html">www2.computer-shogi.org/protocol/tcp_ip_server_121.html</a></p>

<pre>V2.2
N+久保利明 王将
N-都成竜馬 四段
$EVENT:王位戦
$SITE:関西将棋会館
$START_TIME:2017/11/16 10:00:00
$END_TIME:2017/11/16 19:04:00
$OPENING:相振飛車
P1-KY-KE-GI-KI-OU-KI-GI-KE-KY
P2 * -HI *  *  *  *  * -KA *
P3-FU-FU-FU-FU-FU-FU-FU-FU-FU
P4 *  *  *  *  *  *  *  *  *
P5 *  *  *  *  *  *  *  *  *
P6 *  *  *  *  *  *  *  *  *
P7+FU+FU+FU+FU+FU+FU+FU+FU+FU
P8 * +KA *  *  *  *  * +HI *
P9+KY+KE+GI+KI+OU+KI+GI+KE+KY
+
+7776FU
-3334FU
%TORYO</pre>

<p>&gt;&gt; |————<code>--------------</code>———–<code>----------</code>———–<code>------------</code>—————-<code>-------------</code>————–<code>---------------------</code>——————<code>----------------</code>———-<code>----------</code>——–<code>-----------</code>—————-<code>------------------</code>——–<code>----------</code>———————| &gt;&gt; | source     | ki2_location | kif_place | ki2_same | kif_piece | ki2_one_up | ki2_left_right | ki2_up_down | ki2_as_it_is | ki2_promote_trigger | kif_drop_trigger | kif_place_from | csa_sign | csa_from | csa_to | csa_piece | sfen_drop_piece | sfen_drop_trigger | sfen_to | sfen_from | sfen_promote_trigger | &gt;&gt; |————<code>--------------</code>———–<code>----------</code>———–<code>------------</code>—————-<code>-------------</code>————–<code>---------------------</code>——————<code>----------------</code>———-<code>----------</code>——–<code>-----------</code>—————-<code>------------------</code>——–<code>----------</code>———————| &gt;&gt; | ６八銀左上 |              | ６八      |          | 銀        |            | 左             | 上          |              |                     |                  |                |          |          |        |           |                |                  |        |          |                     | &gt;&gt; | △６八全   | △           | ６八      |          | 全        |            |                |             |              |                     |                  |                |          |          |        |           |                |                  |        |          |                     | &gt;&gt; | △６八銀成 | △           | ６八      |          | 銀        |            |                |             |              | 成                  |                  |                |          |          |        |           |                |                  |        |          |                     | &gt;&gt; | △６八銀打 | △           | ６八      |          | 銀        |            |                |             |              |                     | 打               |                |          |          |        |           |                |                  |        |          |                     | &gt;&gt; | △同銀     | △           |           | 同       | 銀        |            |                |             |              |                     |                  |                |          |          |        |           |                |                  |        |          |                     | &gt;&gt; | △同銀成   | △           |           | 同       | 銀        |            |                |             |              | 成                  |                  |                |          |          |        |           |                |                  |        |          |                     | &gt;&gt; | ７六歩(77) |              | ７六      |          | 歩        |            |                |             |              |                     |                  | (77)           |          |          |        |           |                |                  |        |          |                     | &gt;&gt; | 7677FU     |              |           |          |           |            |                |             |              |                     |                  |                |          |       76 |     77 | FU        |                |                  |        |          |                     | &gt;&gt; | -7677FU    |              |           |          |           |            |                |             |              |                     |                  |                | -        |       76 |     77 | FU        |                |                  |        |          |                     | &gt;&gt; | +0077RY    |              |           |          |           |            |                |             |              |                     |                  |                | +        |       00 |     77 | RY        |                |                  |        |          |                     | &gt;&gt; | 8c8d       |              |           |          |           |            |                |             |              |                     |                  |                |          |          |        |           |                |                  | 8d     | 8c       |                     | &gt;&gt; | P*2f       |              |           |          |           |            |                |             |              |                     |                  |                |          |          |        |           | P              | *                | 2f     |          |                     | &gt;&gt; | 4e5c+      |              |           |          |           |            |                |             |              |                     |                  |                |          |          |        |           |                |                  | 5c     | 4e       | +                   | &gt;&gt; |————<code>--------------</code>———–<code>----------</code>———–<code>------------</code>—————-<code>-------------</code>————–<code>---------------------</code>——————<code>----------------</code>———-<code>----------</code>——–<code>-----------</code>—————-<code>------------------</code>——–<code>----------</code>———————|</p>

<p>角落ちで “33角(22)” とすると下の player.board.fetch(v) でエラーになるなので move_hand があるときは同時に origin_soldier のチェックも必要になる</p>

<p>しかし、このチェックをやりつづけるとバリデーションが爆発するここだけではく <a href="Bioshogi/Piece.html#method-c-fetch"><code>Piece.fetch</code></a> などでも例外は出るかもしれない他の部分でひっかかるならそれは普通に例外を出させてabstract_adapter.rb の perform_validations で例外を捕まえるこの方がシンプルで良い</p>

<p>上下のみを表わす</p>
<ul><li>
<p>先手後手というのは平手の場合だけの名称</p>
</li><li>
<p>駒落ちなら、まず名称が上手下手に代わり、もともと後手と呼ばれていた上側が先に指す</p>
</li><li>
<p>先手というのが「先に指す」という意味で使われるなら「先手」は位置を特定できない。駒落ちなら△で、平手なら▲になる。</p>
</li><li>
<p>だから上下の位置を表わすのに先手後手の名前を使うのはまちがい</p>
</li><li>
<p>上下は△▲だけに対応する</p>
</li></ul>

<p>▲△と混同しがちだが▲△は場所のことであって順番とは関係がない。たとえば駒落ちの場合は△から指すため「△=後手」と解釈しているとおかしくなる。</p>

<p>設計がおかしくなっていた原因は、このクラスを DTO として扱っていたことにある。last_action_key が「なんでもハッシュ」になっているのも問題である。読み込んだ情報へのアクセスメソッドは、このクラス内に積極的に定義すべき。</p>

<p><a href="Bioshogi/Piece.html#method-c-s_to_h"><code>Piece.s_to_h</code></a>(“飛0 角 竜1 馬2 龍2”)                    # =&gt; {:rook=&gt;3, :bishop=&gt;3} <a href="Bioshogi/Piece.html#method-c-h_to_a"><code>Piece.h_to_a</code></a>(rook: 2, bishop: 1).collect(&amp;:name)      # =&gt; [“飛”, “飛”, “角”] <a href="Bioshogi/Piece.html#method-c-s_to_a"><code>Piece.s_to_a</code></a>(“飛0 角 竜1 馬2 龍2 飛”).collect(&amp;:name) # =&gt; [“飛”, “飛”, “飛”, “飛”, “角”, “角”, “角”] <a href="Bioshogi/Piece.html#method-c-a_to_s"><code>Piece.a_to_s</code></a>([:bishop, “竜”, “竜”])                   # =&gt; “飛二 角” <a href="Bioshogi/Piece.html#method-c-s_to_h2"><code>Piece.s_to_h2</code></a>(“▲歩2 飛 △歩二飛 ▲金”)               # =&gt; {:black=&gt;{:pawn=&gt;2, :rook=&gt;1, :gold=&gt;1}, :white=&gt;{:pawn=&gt;2, :rook=&gt;1}} <a href="Bioshogi/Piece.html#method-c-h_to_s"><code>Piece.h_to_s</code></a>(bishop: 1, rook: 2)                      # =&gt; “飛二 角”</p>

<p>basic_once_vectors      通常の1ベクトルbasic_repeat_vectors    通常の繰り返しベクトルpromoted_once_vectors   成ったときの1ベクトルpromoted_repeat_vectors 成ったときの繰り返しベクトル</p>

<p>座標</p>

<pre class="ruby"><span class="ruby-constant">Place</span>[<span class="ruby-string">&quot;４三&quot;</span>].<span class="ruby-identifier">name</span>   <span class="ruby-comment"># =&gt; &quot;４三&quot;</span>
<span class="ruby-constant">Place</span>[<span class="ruby-string">&quot;４三&quot;</span>].<span class="ruby-identifier">name</span>  <span class="ruby-comment"># =&gt; &quot;４三&quot;</span>
<span class="ruby-constant">Place</span>[<span class="ruby-string">&quot;43&quot;</span>].<span class="ruby-identifier">name</span>    <span class="ruby-comment"># =&gt; &quot;４三&quot;</span>
</pre>

<p>|————-<code>--------------------------------------</code>———————————————————-| | 属性        | 意味                                 | 備考                                                     | |————-<code>--------------------------------------</code>———————————————————-| | hirate_like | ほぼ平手の配置か？                   |                                                          | | minor       | 一般的なソフトが対応してないものか？ | 「手合割：トンボ」などと表記すると一般的なソフトはバグる | | handicap    | △が初手を指すか？                   |                                                          | | x_taden     | 銀多伝・金多伝を許可するか？         |                                                          | |————-<code>--------------------------------------</code>———————————————————-|</p>

<p>画像変換</p>

<pre>Parser.parse(...).to_png</pre>

<p>五角形の駒</p>

<p>soldier_box = SoldierBox.new soldier_box &lt;&lt; <a href="Bioshogi/Soldier.html#method-c-from_str"><code>Soldier.from_str</code></a>(“△５一玉”) soldier_box &lt;&lt; <a href="Bioshogi/Soldier.html#method-c-from_str"><code>Soldier.from_str</code></a>(“▲６八銀”) soldier_box.collect(&amp;:name)                                             # =&gt; [“△５一玉”, “▲６八銀”] soldier_box.sorted_soldiers.collect(&amp;:name)                             # =&gt; [“▲６八銀”, “△５一玉”] soldier_box.place_as_key_table.collect { |p, s| [p.name, s.name] }.to_h # =&gt; {“５一”=&gt;“△５一玉”, “６八”=&gt;“▲６八銀”} soldier_box.location_split.transform_values { |e| e.collect(&amp;:name) }   # =&gt; {:<a href="&quot;▲６八銀&quot;">black=&gt;</a>, :<a href="&quot;△５一玉&quot;">white=&gt;</a>} soldier_box.location_adjust.transform_values { |e| e.collect(&amp;:name) }  # =&gt; {:black=&gt;[“▲６八銀”, “△５一玉”], :white=&gt;[“△４二銀”, “▲５九玉”]}</p>

  </section>

  <section id="5Buntitled-5D" class="documentation-section anchor-link">


    <section class="constants-list">
      <header>
        <h3>Constants</h3>
      </header>
      <dl>
        <dt id="ANALYSIS_VERSION">ANALYSIS_VERSION
        <dd>
          
        <dt id="ASSETS_DIR">ASSETS_DIR
        <dd>
          
        <dt id="LOG_DIR">LOG_DIR
        <dd>
          
        <dt id="OV">OV
        <dd>
          
        <dt id="ROOT">ROOT
        <dd>
          
        <dt id="RV">RV
        <dd>
          
        <dt id="SFEN1">SFEN1
        <dd>
          
        <dt id="SFEN2">SFEN2
        <dd>
          
        <dt id="TMP_DIR">TMP_DIR
        <dd>
          
        <dt id="VERSION">VERSION
        <dd>
          
      </dl>
    </section>



     <section id="public-class-5Buntitled-5D-method-details" class="method-section anchor-link">
       <header>
         <h3>Public Class Methods</h3>
       </header>

      <div id="method-c-fetch" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-c-fetch" title="Link to this method">
                <span class="method-name">fetch</span>
                <span class="method-args">(...)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="fetch-source">
            <pre><span class="ruby-comment"># File lib/bioshogi/application_memory_record.rb, line 10</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">fetch</span>(<span class="ruby-operator">...</span>)
  <span class="ruby-keyword">super</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">KeyError</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">error</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">KeyNotFound</span>, <span class="ruby-identifier">error</span>.<span class="ruby-identifier">message</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
            <div class="method-calls-super">
              Calls superclass method
              
            </div>
        </div>


      </div>

    </section>

     <section id="public-instance-5Buntitled-5D-method-details" class="method-section anchor-link">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

      <div id="method-i-default_params" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-default_params" title="Link to this method">
                <span class="method-name">default_params</span>
                <span class="method-args">()</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="default_params-source">
            <pre><span class="ruby-comment"># File lib/bioshogi/builder.rb, line 4</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">default_params</span>
  {}
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-hand_log" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-hand_log" title="Link to this method">
                <span class="method-name">hand_log</span>
                <span class="method-args">()</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="hand_log-source">
            <pre><span class="ruby-comment"># File lib/bioshogi/hand_logs_mod.rb, line 11</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">hand_log</span>
  <span class="ruby-ivar">@hand_log</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">HandLog</span>.<span class="ruby-identifier">new</span>({
      <span class="ruby-value">:drop_hand</span>          <span class="ruby-operator">=&gt;</span> <span class="ruby-ivar">@drop_hand</span>,
      <span class="ruby-value">:move_hand</span>          <span class="ruby-operator">=&gt;</span> <span class="ruby-ivar">@move_hand</span>,
      <span class="ruby-value">:candidate_soldiers</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-ivar">@candidate_soldiers</span>, <span class="ruby-comment"># nil の場合もある</span>
      <span class="ruby-value">:place_same</span>         <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">place_same?</span>,
      <span class="ruby-value">:tag_bundle</span>          <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">tag_bundle</span>,
      <span class="ruby-value">:handicap</span>           <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">container</span>.<span class="ruby-identifier">turn_info</span>.<span class="ruby-identifier">handicap?</span>,
      <span class="ruby-value">:single_clock</span>       <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">player</span>.<span class="ruby-identifier">single_clock</span>.<span class="ruby-identifier">clone</span>.<span class="ruby-identifier">freeze</span>, <span class="ruby-comment"># 時計の状態を保持して手に結びつける</span>
    }).<span class="ruby-identifier">freeze</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-inspect" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-inspect" title="Link to this method">
                <span class="method-name">inspect</span>
                <span class="method-args">()</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="inspect-source">
            <pre><span class="ruby-comment"># File lib/bioshogi/application_memory_record.rb, line 17</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">inspect</span>
  <span class="ruby-node">&quot;&lt;#{key}&gt;&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-place_same-3F" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-place_same-3F" title="Link to this method">
                <span class="method-name">place_same?</span>
                <span class="method-args">()</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="place_same-3F-source">
            <pre><span class="ruby-comment"># File lib/bioshogi/hand_logs_mod.rb, line 23</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">place_same?</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">hand_log</span> = <span class="ruby-identifier">container</span>.<span class="ruby-identifier">hand_logs</span>.<span class="ruby-identifier">last</span>
    <span class="ruby-identifier">hand_log</span>.<span class="ruby-identifier">soldier</span>.<span class="ruby-identifier">place</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">soldier</span>.<span class="ruby-identifier">place</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-turn_ended_process" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-turn_ended_process" title="Link to this method">
                <span class="method-name">turn_ended_process</span>
                <span class="method-args">()</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="turn_ended_process-source">
            <pre><span class="ruby-comment"># File lib/bioshogi/hand_logs_mod.rb, line 5</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">turn_ended_process</span>
  <span class="ruby-keyword">super</span>

  <span class="ruby-identifier">container</span>.<span class="ruby-identifier">hand_logs</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">hand_log</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
            <div class="method-calls-super">
              Calls superclass method
              
            </div>
        </div>


      </div>

    </section>

  </section>
</main>

