require "#{__dir__}/setup"

info = Parser.parse(<<~EOT)
開始日時：1956/01/19
終了日時：1956/01/20
棋戦：王将戦
戦型：四間飛車
備考：△３四銀型
消費時間：▲490△485
手合割：香落ち
下手：大山康晴
上手：升田幸三

場所：東京都港区赤坂「比良野」
持ち時間：10時間
*棋戦詳細：第05期王将戦七番勝負第4局
*「大山康晴名人」vs「升田幸三八段」
*差し込み局
*解説は、講談社文庫「升田将棋勝局集」 P.119 〜
△３四歩    ▲２六歩    △３二銀    ▲２五歩    △３三角    ▲４八銀
△４四歩    ▲７六歩    △３五歩    ▲１六歩    △４三銀    ▲１五歩
△３四銀    ▲６八玉    △４二飛    ▲７八玉    △６二玉    ▲５八金右
△７二玉    ▲９六歩    △９四歩    ▲５六歩    △８二玉    ▲５七銀
△７二銀    ▲６八銀上  △５二金左  ▲５五歩    △６四歩    ▲５六銀
△７四歩    ▲２六飛    △６三金    ▲５七銀    △７三桂    ▲６六歩
△４五歩    ▲６八金直  △８四歩    ▲７七桂    △８三銀    ▲６五歩
△同　歩    ▲同　桂    △同　桂    ▲同　銀    △６四歩    ▲５六銀引
△７二金    ▲６六銀    △８五歩    ▲５七金直  △２二飛    ▲２八飛
△２四歩    ▲１八飛    △４三銀    ▲１四歩    △同　歩    ▲同　飛
△１三歩    ▲１六飛    △２五歩    ▲６五歩    △２六歩    ▲６四歩
△６二金引  ▲１二歩    △２七歩成  ▲１一歩成  △１七と    ▲２一と
*勝負を決めた問題の一手！
*正解は、▲１七同桂、▽２七飛成、▲２五桂(妙手)、▽同竜、▲２一と。
*これだと▲１七香と逃げる必要が無く、一手稼げる。
△２九飛成  ▲１三飛成  △４四銀    ▲１七香    △８四桂    ▲６七銀
△３六歩    ▲同　歩    △２四角    ▲２二龍    △３三銀    ▲３二龍
△９五歩
*緩手！
*正しくは、▽１六桂、▲同香、▽１五歩。
*しかし、逆転はなかった。
▲３五桂    △９六歩    ▲９八歩    △７三桂    ▲５四歩    △８六歩
▲同　歩    △８七歩    ▲同　玉    △８五歩    ▲同　歩    △同　桂
▲６九桂    △３八龍    ▲５八金引  △３六龍    ▲２三桂成  △６八角成
▲同　金    △９七金    ▲同　歩    △同歩成    ▲８六玉    △６六龍
▲同　角    △９五銀
まで111手で上手の勝ち
EOT

puts "-" * 80
puts info.to_ki2
puts "-" * 80
puts info.to_kif
puts "-" * 80
puts info.to_csa

container = Container::Basic.new
container.placement_from_preset("香落ち")
puts container
container.execute("３四歩")
puts container

# >> --------------------------------------------------------------------------------
# >> 開始日時：1956/01/19
# >> 終了日時：1956/01/20
# >> 棋戦：王将戦
# >> 戦法：四間飛車
# >> 備考：△３四銀型
# >> 消費時間：▲490△485
# >> 手合割：香落ち
# >> 下手：大山康晴
# >> 上手：升田幸三
# >> 場所：東京都港区赤坂「比良野」
# >> 持ち時間：10時間
# >> 下手の囲い：舟囲い
# >> 上手の囲い：高美濃囲い, 銀冠
# >> 下手の戦法：5筋位取り
# >> 上手の戦法：四間飛車
# >>
# >> △３四歩 ▲２六歩   △３二銀   ▲２五歩   △３三角 ▲４八銀   △４四歩   ▲７六歩   △３五歩   ▲１六歩
# >> △４三銀 ▲１五歩   △３四銀   ▲６八玉   △４二飛 ▲７八玉   △６二玉   ▲５八金右 △７二玉   ▲９六歩
# >> △９四歩 ▲５六歩   △８二玉   ▲５七銀   △７二銀 ▲６八銀上 △５二金左 ▲５五歩   △６四歩   ▲５六銀
# >> △７四歩 ▲２六飛   △６三金   ▲５七銀   △７三桂 ▲６六歩   △４五歩   ▲６八金上 △８四歩   ▲７七桂
# >> △８三銀 ▲６五歩   △同　歩   ▲同　桂   △同　桂 ▲同　銀   △６四歩   ▲５六銀引 △７二金   ▲６六銀
# >> △８五歩 ▲５七金直 △２二飛   ▲２八飛   △２四歩 ▲１八飛   △４三銀   ▲１四歩   △同　歩   ▲同　飛
# >> △１三歩 ▲１六飛   △２五歩   ▲６五歩   △２六歩 ▲６四歩   △６二金引 ▲１二歩   △２七歩成 ▲１一歩成
# >> △１七と ▲２一と   △２九飛成 ▲１三飛成 △４四銀 ▲１七香   △８四桂   ▲６七銀   △３六歩   ▲同　歩
# >> △２四角 ▲２二龍   △３三銀   ▲３二龍   △９五歩 ▲３五桂   △９六歩   ▲９八歩   △７三桂   ▲５四歩
# >> △８六歩 ▲同　歩   △８七歩   ▲同　玉   △８五歩 ▲同　歩   △同　桂   ▲６九桂   △３八龍   ▲５八金引
# >> △３六龍 ▲２三桂成 △６八角成 ▲同　金   △９七金 ▲同　歩   △同歩成   ▲８六玉   △６六龍   ▲同　角
# >> △９五銀
# >> まで111手で上手の勝ち
# >> --------------------------------------------------------------------------------
# >> 開始日時：1956/01/19
# >> 終了日時：1956/01/20
# >> 棋戦：王将戦
# >> 戦法：四間飛車
# >> 備考：△３四銀型
# >> 消費時間：▲490△485
# >> 手合割：香落ち
# >> 下手：大山康晴
# >> 上手：升田幸三
# >> 場所：東京都港区赤坂「比良野」
# >> 持ち時間：10時間
# >> 下手の囲い：舟囲い
# >> 上手の囲い：高美濃囲い, 銀冠
# >> 下手の戦法：5筋位取り
# >> 上手の戦法：四間飛車
# >> 手数----指手---------消費時間--
# >>    1 ３四歩(33)   (00:00/00:00:00)
# >>    2 ２六歩(27)   (00:00/00:00:00)
# >>    3 ３二銀(31)   (00:00/00:00:00)
# >>    4 ２五歩(26)   (00:00/00:00:00)
# >>    5 ３三角(22)   (00:00/00:00:00)
# >>    6 ４八銀(39)   (00:00/00:00:00)
# >>    7 ４四歩(43)   (00:00/00:00:00)
# >>    8 ７六歩(77)   (00:00/00:00:00)
# >>    9 ３五歩(34)   (00:00/00:00:00)
# >>   10 １六歩(17)   (00:00/00:00:00)
# >>   11 ４三銀(32)   (00:00/00:00:00)
# >>   12 １五歩(16)   (00:00/00:00:00)
# >>   13 ３四銀(43)   (00:00/00:00:00)
# >>   14 ６八玉(59)   (00:00/00:00:00)
# >>   15 ４二飛(82)   (00:00/00:00:00)
# >> *△戦法：四間飛車
# >>   16 ７八玉(68)   (00:00/00:00:00)
# >>   17 ６二玉(51)   (00:00/00:00:00)
# >>   18 ５八金(49)   (00:00/00:00:00)
# >>   19 ７二玉(62)   (00:00/00:00:00)
# >>   20 ９六歩(97)   (00:00/00:00:00)
# >>   21 ９四歩(93)   (00:00/00:00:00)
# >>   22 ５六歩(57)   (00:00/00:00:00)
# >> *▲囲い：舟囲い
# >>   23 ８二玉(72)   (00:00/00:00:00)
# >>   24 ５七銀(48)   (00:00/00:00:00)
# >>   25 ７二銀(71)   (00:00/00:00:00)
# >> *△囲い：片美濃囲い
# >>   26 ６八銀(79)   (00:00/00:00:00)
# >>   27 ５二金(41)   (00:00/00:00:00)
# >> *△囲い：美濃囲い
# >>   28 ５五歩(56)   (00:00/00:00:00)
# >> *▲戦法：5筋位取り
# >>   29 ６四歩(63)   (00:00/00:00:00)
# >>   30 ５六銀(57)   (00:00/00:00:00)
# >>   31 ７四歩(73)   (00:00/00:00:00)
# >>   32 ２六飛(28)   (00:00/00:00:00)
# >>   33 ６三金(52)   (00:00/00:00:00)
# >> *△囲い：高美濃囲い
# >>   34 ５七銀(68)   (00:00/00:00:00)
# >>   35 ７三桂(81)   (00:00/00:00:00)
# >>   36 ６六歩(67)   (00:00/00:00:00)
# >>   37 ４五歩(44)   (00:00/00:00:00)
# >>   38 ６八金(69)   (00:00/00:00:00)
# >>   39 ８四歩(83)   (00:00/00:00:00)
# >>   40 ７七桂(89)   (00:00/00:00:00)
# >>   41 ８三銀(72)   (00:00/00:00:00)
# >>   42 ６五歩(66)   (00:00/00:00:00)
# >>   43 ６五歩(64)   (00:00/00:00:00)
# >>   44 ６五桂(77)   (00:00/00:00:00)
# >>   45 ６五桂(73)   (00:00/00:00:00)
# >>   46 ６五銀(56)   (00:00/00:00:00)
# >>   47 ６四歩打     (00:00/00:00:00)
# >>   48 ５六銀(65)   (00:00/00:00:00)
# >>   49 ７二金(61)   (00:00/00:00:00)
# >> *△囲い：銀冠
# >>   50 ６六銀(57)   (00:00/00:00:00)
# >>   51 ８五歩(84)   (00:00/00:00:00)
# >>   52 ５七金(58)   (00:00/00:00:00)
# >>   53 ２二飛(42)   (00:00/00:00:00)
# >>   54 ２八飛(26)   (00:00/00:00:00)
# >>   55 ２四歩(23)   (00:00/00:00:00)
# >>   56 １八飛(28)   (00:00/00:00:00)
# >>   57 ４三銀(34)   (00:00/00:00:00)
# >>   58 １四歩(15)   (00:00/00:00:00)
# >>   59 １四歩(13)   (00:00/00:00:00)
# >>   60 １四飛(18)   (00:00/00:00:00)
# >>   61 １三歩打     (00:00/00:00:00)
# >>   62 １六飛(14)   (00:00/00:00:00)
# >>   63 ２五歩(24)   (00:00/00:00:00)
# >>   64 ６五歩打     (00:00/00:00:00)
# >>   65 ２六歩(25)   (00:00/00:00:00)
# >>   66 ６四歩(65)   (00:00/00:00:00)
# >>   67 ６二金(63)   (00:00/00:00:00)
# >>   68 １二歩打     (00:00/00:00:00)
# >>   69 ２七歩成(26) (00:00/00:00:00)
# >>   70 １一歩成(12) (00:00/00:00:00)
# >>   71 １七と(27)   (00:00/00:00:00)
# >>   72 ２一と(11)   (00:00/00:00:00)
# >>   73 ２九飛成(22) (00:00/00:00:00)
# >>   74 １三飛成(16) (00:00/00:00:00)
# >>   75 ４四銀(43)   (00:00/00:00:00)
# >>   76 １七香(19)   (00:00/00:00:00)
# >>   77 ８四桂打     (00:00/00:00:00)
# >>   78 ６七銀(56)   (00:00/00:00:00)
# >>   79 ３六歩(35)   (00:00/00:00:00)
# >>   80 ３六歩(37)   (00:00/00:00:00)
# >>   81 ２四角(33)   (00:00/00:00:00)
# >>   82 ２二龍(13)   (00:00/00:00:00)
# >>   83 ３三銀(44)   (00:00/00:00:00)
# >>   84 ３二龍(22)   (00:00/00:00:00)
# >>   85 ９五歩(94)   (00:00/00:00:00)
# >>   86 ３五桂打     (00:00/00:00:00)
# >>   87 ９六歩(95)   (00:00/00:00:00)
# >>   88 ９八歩打     (00:00/00:00:00)
# >>   89 ７三桂打     (00:00/00:00:00)
# >>   90 ５四歩(55)   (00:00/00:00:00)
# >>   91 ８六歩(85)   (00:00/00:00:00)
# >>   92 ８六歩(87)   (00:00/00:00:00)
# >>   93 ８七歩打     (00:00/00:00:00)
# >>   94 ８七玉(78)   (00:00/00:00:00)
# >>   95 ８五歩打     (00:00/00:00:00)
# >>   96 ８五歩(86)   (00:00/00:00:00)
# >>   97 ８五桂(73)   (00:00/00:00:00)
# >>   98 ６九桂打     (00:00/00:00:00)
# >>   99 ３八龍(29)   (00:00/00:00:00)
# >>  100 ５八金(57)   (00:00/00:00:00)
# >>  101 ３六龍(38)   (00:00/00:00:00)
# >>  102 ２三桂成(35) (00:00/00:00:00)
# >>  103 ６八角成(24) (00:00/00:00:00)
# >>  104 ６八金(58)   (00:00/00:00:00)
# >>  105 ９七金打     (00:00/00:00:00)
# >>  106 ９七歩(98)   (00:00/00:00:00)
# >>  107 ９七歩成(96) (00:00/00:00:00)
# >>  108 ８六玉(87)   (00:00/00:00:00)
# >>  109 ６六龍(36)   (00:00/00:00:00)
# >>  110 ６六角(88)   (00:00/00:00:00)
# >>  111 ９五銀打     (00:00/00:00:00)
# >>  112 投了
# >> まで111手で上手の勝ち
# >> --------------------------------------------------------------------------------
# >> V2.2
# >> $EVENT:王将戦
# >> $SITE:東京都港区赤坂「比良野」
# >> $START_TIME:1956/01/19
# >> $END_TIME:1956/01/20
# >> $OPENING:四間飛車
# >> $TIME_LIMIT:10:00+00
# >> ' 手合割:香落ち
# >> P1-KY-KE-GI-KI-OU-KI-GI-KE *
# >> P2 * -HI *  *  *  *  * -KA *
# >> P3-FU-FU-FU-FU-FU-FU-FU-FU-FU
# >> P4 *  *  *  *  *  *  *  *  *
# >> P5 *  *  *  *  *  *  *  *  *
# >> P6 *  *  *  *  *  *  *  *  *
# >> P7+FU+FU+FU+FU+FU+FU+FU+FU+FU
# >> P8 * +KA *  *  *  *  * +HI *
# >> P9+KY+KE+GI+KI+OU+KI+GI+KE+KY
# >> -
# >> -3334FU
# >> +2726FU
# >> -3132GI
# >> +2625FU
# >> -2233KA
# >> +3948GI
# >> -4344FU
# >> +7776FU
# >> -3435FU
# >> +1716FU
# >> -3243GI
# >> +1615FU
# >> -4334GI
# >> +5968OU
# >> -8242HI
# >> +6878OU
# >> -5162OU
# >> +4958KI
# >> -6272OU
# >> +9796FU
# >> -9394FU
# >> +5756FU
# >> -7282OU
# >> +4857GI
# >> -7172GI
# >> +7968GI
# >> -4152KI
# >> +5655FU
# >> -6364FU
# >> +5756GI
# >> -7374FU
# >> +2826HI
# >> -5263KI
# >> +6857GI
# >> -8173KE
# >> +6766FU
# >> -4445FU
# >> +6968KI
# >> -8384FU
# >> +8977KE
# >> -7283GI
# >> +6665FU
# >> -6465FU
# >> +7765KE
# >> -7365KE
# >> +5665GI
# >> -0064FU
# >> +6556GI
# >> -6172KI
# >> +5766GI
# >> -8485FU
# >> +5857KI
# >> -4222HI
# >> +2628HI
# >> -2324FU
# >> +2818HI
# >> -3443GI
# >> +1514FU
# >> -1314FU
# >> +1814HI
# >> -0013FU
# >> +1416HI
# >> -2425FU
# >> +0065FU
# >> -2526FU
# >> +6564FU
# >> -6362KI
# >> +0012FU
# >> -2627TO
# >> +1211TO
# >> -2717TO
# >> +1121TO
# >> -2229RY
# >> +1613RY
# >> -4344GI
# >> +1917KY
# >> -0084KE
# >> +5667GI
# >> -3536FU
# >> +3736FU
# >> -3324KA
# >> +1322RY
# >> -4433GI
# >> +2232RY
# >> -9495FU
# >> +0035KE
# >> -9596FU
# >> +0098FU
# >> -0073KE
# >> +5554FU
# >> -8586FU
# >> +8786FU
# >> -0087FU
# >> +7887OU
# >> -0085FU
# >> +8685FU
# >> -7385KE
# >> +0069KE
# >> -2938RY
# >> +5758KI
# >> -3836RY
# >> +3523NK
# >> -2468UM
# >> +5868KI
# >> -0097KI
# >> +9897FU
# >> -9697TO
# >> +8786OU
# >> -3666RY
# >> +8866KA
# >> -0095GI
# >> %TORYO
# >> 上手の持駒：なし
# >>   ９ ８ ７ ６ ５ ４ ３ ２ １
# >> +---------------------------+
# >> |v香v桂v銀v金v玉v金v銀v桂 ・|一
# >> | ・v飛 ・ ・ ・ ・ ・v角 ・|二
# >> |v歩v歩v歩v歩v歩v歩v歩v歩v歩|三
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|四
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|五
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|六
# >> | 歩 歩 歩 歩 歩 歩 歩 歩 歩|七
# >> | ・ 角 ・ ・ ・ ・ ・ 飛 ・|八
# >> | 香 桂 銀 金 玉 金 銀 桂 香|九
# >> +---------------------------+
# >> 下手の持駒：なし
# >> 手数＝0 まで
# >>
# >> 上手番
# >> 上手の持駒：なし
# >>   ９ ８ ７ ６ ５ ４ ３ ２ １
# >> +---------------------------+
# >> |v香v桂v銀v金v玉v金v銀v桂 ・|一
# >> | ・v飛 ・ ・ ・ ・ ・v角 ・|二
# >> |v歩v歩v歩v歩v歩v歩 ・v歩v歩|三
# >> | ・ ・ ・ ・ ・ ・v歩 ・ ・|四
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|五
# >> | ・ ・ ・ ・ ・ ・ ・ ・ ・|六
# >> | 歩 歩 歩 歩 歩 歩 歩 歩 歩|七
# >> | ・ 角 ・ ・ ・ ・ ・ 飛 ・|八
# >> | 香 桂 銀 金 玉 金 銀 桂 香|九
# >> +---------------------------+
# >> 下手の持駒：なし
# >> 手数＝1 △３四歩(33) まで
